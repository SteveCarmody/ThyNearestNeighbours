panel.text(0.925,0.59, "temperature", cex = 1, font =3)
trellis.unfocus()
# Load required libraries
library(zoo)
library(lattice)
library(latticeExtra)
# Import data from text file
raw.data <- read.table("http://www.econ.upf.edu/~michael/visualdata/data/eklima.txt", skip=17, nrows=1140)
# Tranform data and perform additional calculations
temp.pre <- as.data.frame(raw.data[,2:3]) # Select only required columns
temp.pre[,1] <- as.yearmon(sprintf("%.4f",temp.pre[,1]),"%m.%Y") # Transform first column in Mon YYYY format
colnames(temp.pre) <- c("Month","TAM") # Rename column
# Calculate annual averages
avg <- rep(0,length=nrow(temp.pre)) # initialise empty vector of annual averages
years <- nrow(temp.pre)/12 # number of years in dataset
for (k in 1:(years)) {
avg[(12*(k-1)+1):(12*(k-1)+12)] <- mean(temp.pre[(12*(k-1)+1):(12*(k-1)+12),2])
}
temp.pre["AVG"] <- avg
# Calculate record monthly maxima and minima
# First split data by month
jan <- rep(0,length=nrow(temp.pre))
feb <- rep(0,length=nrow(temp.pre))
mar <- rep(0,length=nrow(temp.pre))
apr <- rep(0,length=nrow(temp.pre))
may <- rep(0,length=nrow(temp.pre))
jun <- rep(0,length=nrow(temp.pre))
jul <- rep(0,length=nrow(temp.pre))
aug <- rep(0,length=nrow(temp.pre))
sep <- rep(0,length=nrow(temp.pre))
oct <- rep(0,length=nrow(temp.pre))
nov <- rep(0,length=nrow(temp.pre))
dec <- rep(0,length=nrow(temp.pre))
for (k in 1:years) {
for (i in 1:12) {
if (i == 1) {
jan[12*(k-1)+i] <- temp.pre[12*(k-1)+i,2]
}
if (i == 2) {
feb[12*(k-1)+i] <- temp.pre[12*(k-1)+i,2]
}
if (i == 3) {
mar[12*(k-1)+i] <- temp.pre[12*(k-1)+i,2]
}
if (i == 4) {
apr[12*(k-1)+i] <- temp.pre[12*(k-1)+i,2]
}
if (i == 5) {
may[12*(k-1)+i] <- temp.pre[12*(k-1)+i,2]
}
if (i == 6) {
jun[12*(k-1)+i] <- temp.pre[12*(k-1)+i,2]
}
if (i == 7) {
jul[12*(k-1)+i] <- temp.pre[12*(k-1)+i,2]
}
if (i == 8) {
aug[12*(k-1)+i] <- temp.pre[12*(k-1)+i,2]
}
if (i == 9) {
sep[12*(k-1)+i] <- temp.pre[12*(k-1)+i,2]
}
if (i == 10) {
oct[12*(k-1)+i] <- temp.pre[12*(k-1)+i,2]
}
if (i == 11) {
nov[12*(k-1)+i] <- temp.pre[12*(k-1)+i,2]
}
if (i == 12) {
dec[12*(k-1)+i] <- temp.pre[12*(k-1)+i,2]
}
}
}
# Then initialise empty vectors for each month maxima and minima
jan.max <- rep(NA,length=nrow(temp.pre))
jan.min <- rep(NA,length=nrow(temp.pre))
feb.max <- rep(NA,length=nrow(temp.pre))
feb.min <- rep(NA,length=nrow(temp.pre))
mar.max <- rep(NA,length=nrow(temp.pre))
mar.min <- rep(NA,length=nrow(temp.pre))
apr.max <- rep(NA,length=nrow(temp.pre))
apr.min <- rep(NA,length=nrow(temp.pre))
may.max <- rep(NA,length=nrow(temp.pre))
may.min <- rep(NA,length=nrow(temp.pre))
jun.max <- rep(NA,length=nrow(temp.pre))
jun.min <- rep(NA,length=nrow(temp.pre))
jul.max <- rep(NA,length=nrow(temp.pre))
jul.min <- rep(NA,length=nrow(temp.pre))
aug.max <- rep(NA,length=nrow(temp.pre))
aug.min <- rep(NA,length=nrow(temp.pre))
sep.max <- rep(NA,length=nrow(temp.pre))
sep.min <- rep(NA,length=nrow(temp.pre))
oct.max <- rep(NA,length=nrow(temp.pre))
oct.min <- rep(NA,length=nrow(temp.pre))
nov.max <- rep(NA,length=nrow(temp.pre))
nov.min <- rep(NA,length=nrow(temp.pre))
dec.max <- rep(NA,length=nrow(temp.pre))
dec.min <- rep(NA,length=nrow(temp.pre))
# Calculate monthly record maxima and minima
for (i in 2:nrow(temp.pre) ){
# Calculate monthly record maxima
if (jan[i] >= max(jan[1:(i-1)], na.rm=T)) {
jan.max[i] <- jan[i]
}
if (feb[i] >= max(feb[1:(i-1)], na.rm=T)) {
feb.max[i] <- feb[i]
}
if (mar[i] >= max(mar[1:(i-1)], na.rm=T)) {
mar.max[i] <- mar[i]
}
if (apr[i] >= max(apr[1:(i-1)], na.rm=T)) {
apr.max[i] <- apr[i]
}
if (may[i] >= max(may[1:(i-1)], na.rm=T)) {
may.max[i] <- may[i]
}
if (jun[i] >= max(jun[1:(i-1)], na.rm=T)) {
jun.max[i] <- jun[i]
}
if (aug[i] >= max(aug[1:(i-1)], na.rm=T)) {
aug.max[i] <- aug[i]
}
if (sep[i] >= max(sep[1:(i-1)], na.rm=T)) {
sep.max[i] <- sep[i]
}
if (oct[i] >= max(oct[1:(i-1)], na.rm=T)) {
oct.max[i] <- oct[i]
}
if (nov[i] >= max(nov[1:(i-1)], na.rm=T)) {
nov.max[i] <- nov[i]
}
if (dec[i] >= max(dec[1:(i-1)], na.rm=T)) {
dec.max[i] <- dec[i]
}
# Calculate monthly record minima
if (jan[i] < min(jan[1:(i-1)], na.rm=T)) {
jan.min[i] <- jan[i]
}
if (feb[i] < min(feb[1:(i-1)], na.rm=T)) {
feb.min[i] <- feb[i]
}
if (mar[i] < min(mar[1:(i-1)], na.rm=T)) {
mar.min[i] <- mar[i]
}
if (apr[i] < min(apr[1:(i-1)], na.rm=T)) {
apr.min[i] <- apr[i]
}
if (may[i] < min(may[1:(i-1)], na.rm=T)) {
may.min[i] <- may[i]
}
if (jun[i] < min(jun[1:(i-1)], na.rm=T)) {
jun.min[i] <- jun[i]
}
if (jul[i] < min(jul[1:(i-1)], na.rm=T)) {
jul.min[i] <- jul[i]
}
if (aug[i] < min(aug[1:(i-1)], na.rm=T)) {
aug.min[i] <- aug[i]
}
if (sep[i] < min(sep[1:(i-1)], na.rm=T)) {
sep.min[i] <- sep[i]
}
if (oct[i] < min(oct[1:(i-1)], na.rm=T)) {
oct.min[i] <- oct[i]
}
if (nov[i] < min(nov[1:(i-1)], na.rm=T)) {
nov.min[i] <- nov[i]
}
if (dec[i] < min(dec[1:(i-1)], na.rm=T)) {
dec.min[i] <- dec[i]
}
}
# Cleaning up for chart
jan.max[jan.max==0] <- NA
jan.min[jan.min==0] <- NA
feb.max[feb.max==0] <- NA
feb.min[feb.min==0] <- NA
mar.max[mar.max==0] <- NA
mar.min[mar.min==0] <- NA
apr.max[apr.max==0] <- NA
apr.min[apr.min==0] <- NA
may.max[may.max==0] <- NA
may.min[may.min==0] <- NA
jun.max[jun.max==0] <- NA
jun.min[jun.min==0] <- NA
jul.max[jul.max==0] <- NA
jul.min[jul.min==0] <- NA
aug.max[aug.max==0] <- NA
aug.min[aug.min==0] <- NA
sep.max[sep.max==0] <- NA
sep.min[sep.min==0] <- NA
oct.max[oct.max==0] <- NA
oct.min[oct.min==0] <- NA
nov.max[nov.max==0] <- NA
nov.min[nov.min==0] <- NA
dec.max[dec.max==0] <- NA
dec.min[dec.min==0] <- NA
temp.monthly <- zoo(temp.pre[,2], temp.pre[,1]) # Create zoo object for monthly temperature
temp.avg <- zoo(temp.pre[,3],temp.pre[,1])
temp.jan.min <- zoo(jan.min, temp.pre[,1])
temp.jan.max <- zoo(jan.max, temp.pre[,1])
temp.feb.min <- zoo(feb.min, temp.pre[,1])
temp.feb.max <- zoo(feb.max, temp.pre[,1])
temp.mar.min <- zoo(mar.min, temp.pre[,1])
temp.mar.max <- zoo(mar.max, temp.pre[,1])
temp.apr.min <- zoo(apr.min, temp.pre[,1])
temp.apr.max <- zoo(apr.max, temp.pre[,1])
temp.may.min <- zoo(may.min, temp.pre[,1])
temp.may.max <- zoo(may.max, temp.pre[,1])
temp.jun.min <- zoo(jun.min, temp.pre[,1])
temp.jun.max <- zoo(jun.max, temp.pre[,1])
temp.jul.min <- zoo(jul.min, temp.pre[,1])
temp.jul.max <- zoo(jul.max, temp.pre[,1])
temp.aug.min <- zoo(aug.min, temp.pre[,1])
temp.aug.max <- zoo(aug.max, temp.pre[,1])
temp.sep.min <- zoo(sep.min, temp.pre[,1])
temp.sep.max <- zoo(sep.max, temp.pre[,1])
temp.oct.min <- zoo(oct.min, temp.pre[,1])
temp.oct.max <- zoo(oct.max, temp.pre[,1])
temp.nov.min <- zoo(nov.min, temp.pre[,1])
temp.nov.max <- zoo(nov.max, temp.pre[,1])
temp.dec.min <- zoo(dec.min, temp.pre[,1])
temp.dec.max <- zoo(dec.max, temp.pre[,1])
# Plot data
xyplot(temp.monthly, alpha=0.6, xlim=c(1915,2023),
main="Evolution of monthly avg. temperatures at Bear Island (1920-2014)",xlab="Year",
ylab="Temperature", col="grey") +
as.layer( xyplot(temp.avg,col=c("black"), cex=1.5)) +
layer_(panel.xblocks(index(temp.monthly), index(temp.monthly) > "Aug 1984", col = "#E9F2F2")) +
as.layer( xyplot(temp.jan.min,col=c("blue"), fill=c("blue"), type=c("p"))) +
as.layer( xyplot(temp.feb.min,col=c("blue"), fill=c("blue"), type=c("p"))) +
as.layer( xyplot(temp.mar.min,col=c("blue"), fill=c("blue"), type=c("p"))) +
as.layer( xyplot(temp.apr.min,col=c("blue"), fill=c("blue"), type=c("p"))) +
as.layer( xyplot(temp.may.min,col=c("blue"), fill=c("blue"), type=c("p"))) +
as.layer( xyplot(temp.jun.min,col=c("blue"), fill=c("blue"), type=c("p"))) +
as.layer( xyplot(temp.jul.min,col=c("blue"), fill=c("blue"), type=c("p"))) +
as.layer( xyplot(temp.aug.min,col=c("blue"), fill=c("blue"), type=c("p"))) +
as.layer( xyplot(temp.sep.min,col=c("blue"), fill=c("blue"), type=c("p"))) +
as.layer( xyplot(temp.oct.min,col=c("blue"), fill=c("blue"), type=c("p"))) +
as.layer( xyplot(temp.nov.min,col=c("blue"), fill=c("blue"), type=c("p"))) +
as.layer( xyplot(temp.dec.min,col=c("blue"), fill=c("blue"), type=c("p"))) +
as.layer( xyplot(temp.jan.max,col=c("red"), fill=c("red"), type=c("p"))) +
as.layer( xyplot(temp.feb.max,col=c("red"), fill=c("red"), type=c("p"))) +
as.layer( xyplot(temp.mar.max,col=c("red"), fill=c("red"), type=c("p"))) +
as.layer( xyplot(temp.apr.max,col=c("red"), fill=c("red"), type=c("p"))) +
as.layer( xyplot(temp.may.max,col=c("red"), fill=c("red"), type=c("p"))) +
as.layer( xyplot(temp.jun.max,col=c("red"), fill=c("red"), type=c("p"))) +
as.layer( xyplot(temp.jul.max,col=c("red"), fill=c("red"), type=c("p"))) +
as.layer( xyplot(temp.aug.max,col=c("red"), fill=c("red"), type=c("p"))) +
as.layer( xyplot(temp.sep.max,col=c("red"), fill=c("red"), type=c("p"))) +
as.layer( xyplot(temp.oct.max,col=c("red"), fill=c("red"), type=c("p"))) +
as.layer( xyplot(temp.nov.max,col=c("red"), fill=c("red"), type=c("p"))) +
as.layer( xyplot(temp.dec.max,col=c("red"), fill=c("red"), type=c("p")))
trellis.focus("toplevel") ## has coordinate system [0,1] x [0,1]
panel.text(0.785, 0.1, "1984 - 2014", cex = 1, font = 2)
panel.text(0.52, 0.91, "(A dot indicates a new monthly record low (blue) or high (red) average monthly temperature since 1920)")
panel.text(0.925,0.61, "Annual avg.", cex = 1, font =3)
panel.text(0.925,0.59, "temperature", cex = 1, font =3)
trellis.unfocus()
install.package("ggmaps")
install.packages("ggmaps")
install.packages("ggmap")
library(ggmap)
mapImageData1 <- get_map(location = c(lon = -0.016179, lat = 51.538525),
color = "color",
source = "google",
maptype = "satellite",
zoom = 17)
ggmap(mapImageData1,
extent = "device",
ylab = "Latitude",
xlab = "Longitude")
mapImageData2 <- get_map(location = c(lon = -0.016179, lat = 51.538525),
color = "color",
source = "google",
maptype = "terrain",
zoom = 16)
ggmap(mapImageData2,
extent = "device",
ylab = "Latitude",
xlab = "Longitude")
mapImageData2 <- get_map(location = c(lon = -0.016179, lat = 51.538525),
color = "color",
source = "google",
maptype = "terrain",
zoom = 1)
ggmap(mapImageData2,
extent = "device",
ylab = "Latitude",
xlab = "Longitude")
mapImageData2 <- get_map(location = c(lon = -0.016179, lat = 51.538525),
color = "color",
source = "google",
maptype = "terrain",
zoom = 2)
ggmap(mapImageData2,
extent = "device",
ylab = "Latitude",
xlab = "Longitude")
mapImageData3 <- get_map(location = c(lon = -0.016179, lat = 51.538525),
color = "color",
source = "google",
maptype = "roadmap",
zoom = 16)
ggmap(mapImageData3,
extent = "device",
ylab = "Latitude",
xlab = "Longitude")
mapImageData3 <- get_map(location = c(lon = -0.016179, lat = 51.538525),
color = "color",
source = "google",
maptype = "roadmap",
zoom = 12)
mapImageData3 <- get_map(location = c(lon = -0.016179, lat = 51.538525),
color = "color",
source = "google",
maptype = "roadmap",
zoom = 16)
ggmap(mapImageData3,
extent = "device",
ylab = "Latitude",
xlab = "Longitude")
mapImageData4 <- get_map(location = c(lon = -0.016179, lat = 51.538525),
color = "color",
source = "google",
maptype = "hybrid",
zoom = 12)
ggmap(mapImageData4,
extent = "device",
ylab = "Latitude",
xlab = "Longitude")
adm1 <- getData('GADM', country='HUN', level=0)
load("/Users/stefano/Desktop/GBR_adm2.RData")
gadm
as.data.frame(gadm)
paris <- get_map(location = "paris")
ggmap(paris,
extent = "device",
ylab = "Latitude",
xlab = "Longitude")
library(devtools)
install_github('R-Package-dynamo', 'ctbrownlees')
library(dynamo)
?dynamo
?dynamo
?arch-models
?garch.filter
install_github('ctbrownlees/R-Package-dynamo')
library(dynamo)
?garch.filter
garch.fit
?dynamo
library(devtools)
install_github('ctbrownlees/R-Package-dynamo')
library(dynamo)
?dynamo
?dynamo-package
?dm
data( sp500 )
ret <- diff( log( sp500$price ) )*100
garch11 <- dm( ret ~ garch )
garch11
summary(garch)
summary(garch11)
plot(garch11)
data(iris)
?doMC.package
data(iris)
train <- iris[1:100,]
test <- iris[101:150,]
iris.adaboost <- boosting(Species ~ ., data=iris[sub,], mfinal=10)
library(adabag)
iris.adaboost <- boosting(Species ~ ., data=iris[1:100,], mfinal=10)
iris.predboosting<- predict.boosting(iris.adaboost, newdata=iris[101:150,])
iris.predboosting
iris[101:150,5]
library(doMC)
library(doMC)
registerDoMC(cores = 3)
iris.adaboost <- boosting(Species ~ ., data=iris[1:100,], mfinal=10)
?boosting
iris.adaboost <- boosting(Species ~ ., data=iris[1:100,], mfinal=100)
iris.predboosting<- predict.boosting(iris.adaboost, newdata=iris[101:150,])
iris.predboosting
iris[101:150,5]
iris.predboosting$class
head(data)
setwd("~/Dropbox/MSc Data Science/Courses/006 - Machine Learning (14D005)/Competition/ThyNearestNeighbours")
rm( list=ls() )
if (!require("class")) install.packages("class")
library(class)
if (!require("foreach")) install.packages("foreach")
library(foreach)
if (!require("doSNOW")) install.packages("doSNOW")
library(doSNOW)
if (!require("adabag")) install.packages("adabag")
library(adabag)
if (!require("rpart")) install.packages("rpart")
library(rpart)
D <- read.table("Kaggle_Covertype_training.csv", head = TRUE, stringsAsFactors=FALSE)
colNames <- names(D)
colNames <- strsplit(colNames, '[.]')
colNames <- unlist(colNames)
# create empty data frame
data.raw <- data.frame()
data.raw <- t(data.frame(strsplit(D[,], ','), stringsAsFactors = FALSE))
rownames(data.raw) <- NULL
data.raw <- data.frame(data.raw, stringsAsFactors = FALSE)
names(data.raw) <- colNames
dataCorrectMat <- data.matrix(data.raw)
# Scales data for non boolean values
data.scaled <- data.frame()
for(i in 2:11){
data.raw[,i] <- as.double(scale(as.numeric(data.raw[,i]), center = TRUE, scale = TRUE))
}
data.scaled <- data.raw
data <- head(data.scaled, 5000)
head(data)
# Limit amount of data used to save compute time
data <- head(data.scaled, 500)
sampleIndex <- sample(1:nrow(data), size = (nrow(data)*.9), replace = FALSE, prob = NULL)
# select training data
train <- data[sampleIndex,-1]
# select testing data
test <- data[-sampleIndex,-1]
# fitting the model
adafit <- boosting(Cover_Type ~ ., data=train, mfinal=10)
adapred <- predict.boosting(adafit, newdata = test)
adaerror <- mean(adapred$class != test[,ncol(test)])
# last thing is returned
result <- testError
}
)
# puts results in a data table
resultsAda
train <- data[sampleIndex,-1]
train
head(train)
train <- data[sampleIndex,-1]
test <- data[-sampleIndex,-1]
adafit <- boosting(Cover_Type ~ ., data=train, mfinal=10)
head(train)
adafit <- boosting(Cover_Type ~ ., data=train, mfinal=10)
adafit <- boosting(Cover_Type ~ ., data=train, mfinal=10)
adafit <- boosting(Cover_Type ~ ., data=train, mfinal=100)
head(train)
train
adafit <- bagging(Cover_Type ~ ., data=train, mfinal=100)
adafit <- boosting(Cover_Type ~ ., data=train, mfinal=100)
data <- head(data.scaled, 500)
library(caret)
adafit <- train(Cover_Type ~ ., data=train, method="ada")
adafit <- train(Cover_Type ~ ., data=train, method="AdaBoost.M1")
adafit <- train(Cover_Type ~ ., data = train, method = "ada")
?train
adafit <- train(Cover_Type ~ ., data = train, method = "AdaBoost.M1")
library(caret)
adafit <- train(Cover_Type ~ ., data = train, method = "AdaBoost.M1")
adafit <- boosting(Cover_Type ~ ., data = train)
adafit <- boosting.cv(Cover_Type ~ ., data = train)
train[,20]
as.numeric(train[,20])
head(data)
as.numeric(data)
data[,55]
as.numeric(data[,12:55])
as.numeric(data[,13:55])
as.numeric(data[,55])
as.numeric(data[,54:55])
for (i in 12:55) {
data[,i] <- as.numeric(data[,i])
}
data <- head(data.scaled, 500)
sampleIndex <- sample(1:nrow(data), size = (nrow(data)*.9), replace = FALSE, prob = NULL)
train <- data[sampleIndex,-1]
test <- data[-sampleIndex,-1]
adafit <- boosting.cv(Cover_Type ~ ., data = train)
data <- data.scaled
sampleIndex <- sample(1:nrow(data), size = (nrow(data)*.9), replace = FALSE, prob = NULL)
train <- data[sampleIndex,-1]
test <- data[-sampleIndex,-1]
adafit <- boosting.cv(Cover_Type ~ ., data = train)
data <- head(data.scaled,5000)
sampleIndex <- sample(1:nrow(data), size = (nrow(data)*.9), replace = FALSE, prob = NULL)
train <- data[sampleIndex,-1]
test <- data[-sampleIndex,-1]
adafit <- boosting.cv(Cover_Type ~ ., data = train)
data <- head(data.scaled,1000)
sampleIndex <- sample(1:nrow(data), size = (nrow(data)*.9), replace = FALSE, prob = NULL)
train <- data[sampleIndex,-1]
test <- data[-sampleIndex,-1]
adafit <- boosting.cv(Cover_Type ~ ., data = train)
data <- head(data.scaled,1500)
sampleIndex <- sample(1:nrow(data), size = (nrow(data)*.9), replace = FALSE, prob = NULL)
train <- data[sampleIndex,-1]
test <- data[-sampleIndex,-1]
adafit <- boosting.cv(Cover_Type ~ ., data = train)
data <- head(data.scaled,2000)
sampleIndex <- sample(1:nrow(data), size = (nrow(data)*.9), replace = FALSE, prob = NULL)
train <- data[sampleIndex,-1]
test <- data[-sampleIndex,-1]
adafit <- boosting.cv(Cover_Type ~ ., data = train)
data <- head(data.scaled,4000)
sampleIndex <- sample(1:nrow(data), size = (nrow(data)*.9), replace = FALSE, prob = NULL)
train <- data[sampleIndex,-1]
test <- data[-sampleIndex,-1]
adafit <- boosting.cv(Cover_Type ~ ., data = train)
data <- head(data.scaled,5000)
sampleIndex <- sample(1:nrow(data), size = (nrow(data)*.9), replace = FALSE, prob = NULL)
train <- data[sampleIndex,-1]
test <- data[-sampleIndex,-1]
adafit <- boosting.cv(Cover_Type ~ ., data = train)
